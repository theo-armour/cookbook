<!doctype html>
<html lang=en >
<head>
<title>Read Big File</title>
<meta charset=utf-8 />
<meta name=author content='Theo Armour' />
</head>
<body>
<script>
	fname = 'C:/Users/theo/Desktop/film_tensor.csv';
	var take = 20000000;
	var file = '', data;
	var arr = [];
	var xmlhttp;
	var callbackCount = 0;
	var startTime = new Date();

	init();

	function init() {
		document.body.style.cssText = ' font: bold 12pt monospace; ';

		var info = document.body.appendChild( document.createElement( 'div' ) );
		info.innerHTML = '<h1>' + document.title + '</h1>' +
			'<div id=msg >msg<br></div>';

		requestFile( fname, 0, take );
	}

	function requestFile( fname, start, stop ) {
		xmlhttp = new XMLHttpRequest();
		xmlhttp.open( 'GET', fname, true );
		xmlhttp.onreadystatechange = callback;
		xmlhttp.setRequestHeader('Range', 'bytes=' + start + '-' + stop );
		xmlhttp.send( null );
	}

	function callback() {
		if ( xmlhttp.readyState == 4  ) {
			data = xmlhttp.responseText;
			lines = data.split(/\r\n|\n/);
			length = lines.length - 1;
			var sep = ',';
			for ( var i = 0; i < length; i++ ) {
				arr.push( lines[i].split( sep ) );
			}
			msg.innerHTML += callbackCount++ + ' ' + arr.length + ' ' + ( new Date() - startTime) + '<br>';

			if ( callbackCount < 12 ) {
				requestFile( fname, callbackCount * take, ( callbackCount + 1) * take);
			}
		} else {
console.log('waiting...');
		}
	}


/*

		for (var i = 0; i < 20; i++) {
			data = requestFile( fname, i * take, ( i + 1 ) * take);
			var lines = data.split(/\r\n|\n/);
			arr = arr.concat( lines );
			msg.innerHTML += i + ' ' + arr.length + '<br>';
		}

	function requestFile( fname, start, stop ) {
		var xmlHttp = new XMLHttpRequest();
		xmlHttp.crossOrigin = "Anonymous"; 
		xmlHttp.open( 'GET', fname, false );
		xmlHttp.setRequestHeader('Range', 'bytes=' + start + '-' + stop );
		xmlHttp.send( null );
		return xmlHttp.responseText;
	}
*/

</script>
</body>
</html>